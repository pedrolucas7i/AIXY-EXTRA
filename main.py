"""
===============================================================================================================================================================
===============================================================================================================================================================

                                                                   _      ___  __  __ __   __  ____         ___  
                                                                  / \    |_ _| \ \/ / \ \ / / |___ \       / _ \ 
                                                                 / _ \    | |   \  /   \ V /    __) |     | | | |
                                                                / ___ \   | |   /  \    | |    / __/   _  | |_| |
                                                               /_/   \_\ |___| /_/\_\   |_|   |_____| (_)  \___/ 

                                                               
                                                                            MAIN  MICROPHONE  CODE
                                                                            by Pedro Ribeiro Lucas
                                                                                                                  
===============================================================================================================================================================
===============================================================================================================================================================
"""

import time
from socketio import Client
import env

socketio = Client()
socketio.connect(env.REMOTE_ROBOT_URL)

while True:
    try:
        import listener
        import env

        speaked = listener.transcribe_speech()
        if speaked:
            print(f"[VocÃª disse] {speaked}")
            socketio.emit('aiquestion', speaked)
            time.sleep(3)
    except Exception as e:
        print(f"An error occurred: {e}")
        time.sleep(1)  # Wait before retrying
